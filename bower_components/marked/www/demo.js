$(function(){var $inputElem=$("#input"),$outputTypeElem=$("#outputType"),$previewElem=$("#preview"),$htmlElem=$("#html"),$lexerElem=$("#lexer"),$syntaxElem=$("#syntax"),inputDirty=!0,$activeElem=null;if(top.document.location.href.match(/\?blank=1$/)){$inputElem.val("")}$outputTypeElem.change(function(){$("#rightContainer .pane").hide();$activeElem=$("#"+$outputTypeElem.val()).show()}).change();var noticeChange=function(){inputDirty=!0};$inputElem.change(noticeChange).keyup(noticeChange).keypress(noticeChange).keydown(noticeChange);var jsonString=function(input){var output=(input+"").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\t/g,"\\t").replace(/\f/g,"\\f").replace(/[\\"']/g,"\\$&").replace(/\u0000/g,"\\0");return"\""+output+"\""},getScrollSize=function(){var e=$activeElem[0];return e.scrollHeight-e.clientHeight},getScrollPercent=function(){var size=getScrollSize();if(0>=size){return 1}return $activeElem.scrollTop()/size},setScrollPercent=function(percent){$activeElem.scrollTop(percent*getScrollSize())},delayTime=1,checkForChanges=function(){if(inputDirty){inputDirty=!1;for(var startTime=new Date,scrollPercent=getScrollPercent(),markdown=$inputElem.val(),lexed=marked.lexer(markdown),lexedList=[],i=0,lexedLine;i<lexed.length;i++){lexedLine=[];for(var j in lexed[i]){lexedLine.push(j+":"+jsonString(lexed[i][j]))}lexedList.push("{"+lexedLine.join(", ")+"}")}var parsed=marked.parser(lexed);// Assign
$previewElem.html(parsed);$htmlElem.val(parsed);$lexerElem.val(lexedList.join("\n"));// Set the scroll percent
setScrollPercent(scrollPercent);var endTime=new Date;delayTime=endTime-startTime;if(50>delayTime){delayTime=50}else if(500<delayTime){delayTime=1e3}}window.setTimeout(checkForChanges,delayTime)};checkForChanges();setScrollPercent(0)});